---
title: "Unveiling the Mystery: Exploring Patterns and Associations in UFO Sightings Data"
subtitle: "INFO 526 - Project 1"
author: "Fight Club"
format: html
editor: visual
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidymodels,
               tidyverse,
               gganimate,
               dplyr,
               kableExtra,
               sf, 
               leaflet, 
               ggmap,
               maps,
               lubridate,
               data.table,
               gganimate,
               ggimage,
               png,
               here,
               grid,
               plotly)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )

```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#| label: load-data
#| include: false


ufo_sightings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/ufo_sightings.csv')
places <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/places.csv')
day_parts_map <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/day_parts_map.csv')


```

## Abstract

1.  Our project embarks on a quest to analyze and visualize that might reveal the secrets hidden.
2.  Armed with the powerful ggplot2 library, we embarked on a visual odyssey, crafting intricate visualizations that brought the geographic distribution of UFO sightings to life.
3.  We explored the intriguing correlations between sightings location and the shapes of the reported UFO's, fueling our imaginations with visions of otherwordly visitors.
4.  But our quest did not end there. We delved deeper into the temporal realm, analyzing seasonal patterns in sightings, seeking to unravel the mysteries that might lie hidden within the cycle of season.

## Introduction

UFO sightings dataset - <https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-06-20>. It provides a comprehensive compilation of UFO sightings worldwide.

The UFO Sightings Redux data comes from the National UFO Reporting Center, cleaned and enriched with data from sunrise-sunset.org by Jon Harmo.

The collection of verified UFO sightings from multiple sources is compiled into a comprehensive list called TidyTuesday UFO sightings. The location (latitude and longitude), the time and date of the sighting, the shape of the purported UFO, the duration of the sighting, and any other comments or descriptions provided by witnesses are typically included in this data-set.

## Datasets and Key Variables

The dataset records 80,000 observations.

ufo_sightings.csv: It has 12 variables such as city, state, country_code, and shape. In total 96,429 rows. places.csv: It has 10 variables such as longitude, latitude and time zone, country_code, and alternate_city_names. There are 14,417 rows. day_parts_map.csv: It has 12 variables such as sunrise, sunset, civil_twilight_end, nautical_twilight_end, and astronomical_twilight_end. It s of 26,409 rows.

Why did you choose this data-set? There are several reasons why we chose this data-set. The first reason is that the data is well-formatted and is rich in variables, making it interesting for data wrangling and visualizing patterns. The second reason is the social media engagement and interest in this particular phenomenon.

## Question-1

What is the geographic distribution of UFO sightings? Are there any hotspots where the number of sightings is prevalent? Is there any correlation between the location of the sighting and the shape of the UFO?

#### Introduction

Embarking on a quest to uncover the geographic footprint of UFO sightings, we delved into the data to unveil patterns and hotspots of extraterrestrial encounters. Our journey traversed through spatial landscapes, painting a rich tapestry of sightings across regions. Along the way, we sought to discern any correlations between sighting locations and the enigmatic shapes of UFOs, navigating through the mysteries of the cosmos with data as our compass.

#### Approach

1.  **Heatmap Distribution of UFO Sightings**: The approach begins by aggregating UFO sighting data by country to understand the geographic distribution. This data is then visualized using a heatmap overlay on a world map, with color intensity representing sighting density. By leveraging ggplot and map_data functions, the visualization highlights regions with higher concentrations of sightings, providing a global perspective.

2.  **UFO Sighting Distribution Around the World**: For a closer examination, the analysis zooms in on the United States to identify hotspots of UFO activity. Leveraging the leaflet package, latitude and longitude coordinates of sightings are plotted on an interactive map, allowing users to explore sightings in specific locations. This approach offers a detailed view of sighting prevalence across different states.

3.  **Variance of Shape Sightings**: To understand the diversity of reported UFO shapes, the approach filters out less common shapes and creates a bar plot to visualize the frequency of each shape. By focusing on shapes with higher sighting counts, this analysis reveals which shapes are most frequently reported by witnesses, offering insights into popular UFO descriptions.

4.  **Time-series Plot by Season**: Exploring potential seasonal patterns, the approach categorizes sightings by season and plots the number of sightings over decades. Using emojis to represent seasons adds a human touch to the visualization, making it more engaging. This analysis aims to uncover any recurring patterns or fluctuations in sightings across different seasons over time.

    ```{r}
    #| warning: FALSE} #| echo: FALSE 
    #|  output: FALSE   
    places_location_data <- places |>   select(state, country, latitude, longitude)   places_location_data <- places_location_data %>%   group_by(country) %>%    summarise(sighting_count = n()) %>%   ungroup()
    ```

```{r}

#| warning: FALSE
#| echo: FALSE
#| output: FALSE


world_map <- map_data("world")
colnames(world_map)[5] <- "country"
```

```{r}
#| warning: FALSE
#| echo: FALSE
#| output: FALSE


places_location_data$country <- tolower(places_location_data$country)
world_map$country <- tolower(world_map$country)

```

```{r}
#| warning: FALSE
#| echo: FALSE
#| output: FALSE


heatmap_data <- left_join(world_map, places_location_data, by = "country")

setDT(heatmap_data)

heatmap_data[is.na(sighting_count), sighting_count := 0]

heatmap_data[, sighting_count_range := case_when(sighting_count == 0 ~ "<1",
                                                 sighting_count < 30 ~ "1-29",
                                                 sighting_count < 60 ~ "30-59",
                                                 sighting_count < 150 ~ "60-149",
                                                 sighting_count < 200 ~ "150-299",
                                                 sighting_count < 1000 ~ "300-999",
                                                 sighting_count > 1000 ~ "1000+",
                                                 TRUE ~ "-1")]
heatmap_data$sighting_count_range <- factor(heatmap_data$sighting_count_range,
                                            levels = c("<1","1-29","30-59","60-149","150-299","300-999","1000+"))

```

```{r, fig.width=10, fig.asp=0.7,fig.align='center'}
color_scale_values = c("<1" = "#D8FAFD", 
                       "1-29" = "#8FFAFD", 
                       "30-59" = "#0CFDF3", 
                       "60-149" = "#3282F6", 
                       "150-299" = "#0023F5", 
                       "300-999" = "#00129A", 
                       "1000+" = "#000C7B")

ggplot() + 
  geom_polygon(data = world_map, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  geom_polygon(data = heatmap_data, aes(x = long, y = lat, group = group, fill = sighting_count_range), color = "black") +
  theme_minimal() +
  scale_fill_manual(values =  color_scale_values) +
  coord_fixed(1.3) 
```

#### UFO Sighting Distribution Around the World

```{r}
us_places_data <- places |>
  select(state, country, country_code, latitude, longitude)
us_places_data <- us_places_data |>
  filter(!is.na(latitude) & !is.na(longitude))
us_places_data <- us_places_data |>
  filter(country_code == "US")
```

```{r, fig.align='center'}
map_plot <- leaflet(data = us_places_data) |>
  addTiles() |>
  setView(
    lng = -115,    # Adjusted center longitude for the entire US
    lat = 37,      # Adjusted center latitude for the entire US
    zoom = 3       # Adjusted zoom level
  )


map_plot <- map_plot |>
  addCircleMarkers(lat = ~latitude, lng = ~longitude, color = "#51EE00", stroke = FALSE, fillOpacity = 0.8)

map_plot
```

#### Variance of Shape Sightings

```{r}
shapes_filtered <- ufo_sightings |>
  select(city, state, country_code, shape) |>
  filter(shape != "other" & shape != "unknown")


shapes_filtered <- shapes_filtered |>
  group_by(shape) |>
  filter(dplyr::n() > 1500) |>
  ungroup()
```

```{r}
shape_counts <- shapes_filtered |>
  count(shape)
```

```{r fig.width=13,fig.height=9,fig.align='center', warning=FALSE}
ggplot(shape_counts, aes(x = n, y = shape)) +
  geom_bar(stat = "identity", fill=alpha("#0023F5", 0.5)) +
  xlim(-2000, 19000) +
  coord_polar(theta = "y") +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.title.y = element_blank(),
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 15))
```

```{r, dev='ragg_png', fig.width=10,fig.height=6.5,fig.align='center', warning = FALSE, message=FALSE}

# Time-series plot by season (Usama)

ufo_sightings <- left_join(ufo_sightings, places, by = c("city", 
                                                         "state",
                                                         "country_code"))

ufo_sightings <- ufo_sightings |> 
  filter(!is.na(shape) & shape != "other" & shape != "unknown")

ufo_sightings$decade <- as.integer(format(ufo_sightings$reported_date_time_utc, "%Y")) - as.integer(format(ufo_sightings$reported_date_time_utc, "%Y")) %% 10

ufo_sightings$reported_date <- as.Date(ufo_sightings$reported_date_time, format="%Y-%m-%dT%H:%M:%SZ")

get_season <- function(date) {
  year <- format(date, "%Y")
  start_spring <- as.Date(paste(year, "-03-21", sep=""))
  start_summer <- as.Date(paste(year, "-06-21", sep=""))
  start_autumn <- as.Date(paste(year, "-09-23", sep=""))
  start_winter <- as.Date(paste(year, "-12-21", sep=""))
  
  if (date >= start_spring & date < start_summer) {
    return('spring')
  } else if (date >= start_summer & date < start_autumn) {
    return('summer')
  } else if (date >= start_autumn & date < start_winter) {
    return('autumn')
  } else {
    return('winter')
  }
}

ufo_sightings$season <- sapply(ufo_sightings$reported_date, get_season)

ufo_sightings$season_emoji <- case_when(
      ufo_sightings$season == "winter" ~ "❄️",
      ufo_sightings$season == "spring" ~ "⛅️️",
      ufo_sightings$season == "summer" ~ "☀️",
      ufo_sightings$season == "autumn"   ~ "☂️",
      TRUE ~ "Null")

grouped_data <- ufo_sightings |>
  group_by(decade,season,season_emoji) |>
  summarise(sightings = n())

image <- readPNG(here("images","ufo_background_image.png"))


ggplot(grouped_data, aes(x=decade, y=sightings, color=season)) +
  annotation_custom(rasterGrob(image),
                    xmin=-Inf,
                    xmax=Inf,
                    ymin=-Inf,
                    ymax=Inf) +
  geom_line(linewidth = 0.8) +
  geom_text(aes(label = season_emoji)) +
  scale_y_continuous(breaks = seq(0,14000,2000)) +
  scale_x_continuous(breaks = seq(1920,2020,10)) +
  theme_minimal() +
  labs(title="UFO sightings by season over years",
       x="Decade",
       y="Number of Sightings",
       subtitle = "Sightings by each decade from 1920 till 2020",
       color = "Season") +
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        plot.title.position = "plot",
        legend.position = "none",
        panel.grid.minor.y = element_blank(),
        panel.grid.major.y = element_line(color = "black",
                                          linewidth = 0.5,
                                          linetype = "dotted"),
        panel.background = element_blank(), 
        panel.ontop = TRUE) 
```

#### Analysis:

1.  **Heatmap Distribution of UFO Sightings**: As we gaze upon the heatmap, we see patches of vibrant colors, indicating regions teeming with UFO reports. From bustling urban centers to remote corners of the globe, each hue tells a tale of mysterious sightings, inviting us to delve deeper into the unknown.

2.  **UFO Sighting Distribution Around the World**: Zooming in on the United States, we embark on a virtual journey across states, uncovering clusters of UFO activity like hidden gems waiting to be discovered. With each click, we traverse landscapes rich with stories of strange lights and unidentified objects, igniting our sense of wonder.

3.  **Variance of Shape Sightings**: As we stroll through the gallery of UFO shapes, we marvel at the diversity on display. Some shapes captivate our attention with their frequency, while others intrigue us with their rarity. Each shape adds a layer of complexity to the UFO narrative, leaving us pondering the mysteries of the cosmos.

4.  **Time-series Plot by Season**: Flipping through the pages of time, we observe the ebb and flow of UFO sightings with each passing season. Like characters in a story, seasons come alive with their own quirks and patterns, shaping the narrative of UFO encounters over decades. As we journey through time, we are reminded of the cyclical nature of curiosity and exploration.

## Question-2

Are there any patterns to the sightings concerning seasons? Do astronomical events affect the reported sightings?

#### **introduction**

On a Journey Through the Seasons of UFO Sightings:

Let's delve into the mysteries surrounding UFO encounters and their connection to the ever-changing seasons. Imagine walking through a visual landscape that captures the essence of each season, from the warmth of summer to the chill of winter, all while uncovering patterns in reported sightings. As we navigate through the data, we'll explore whether astronomical events play a role in shaping these enigmatic encounters, inviting you to ponder the cosmic dance between the unknown and the familiar.

#### Approach

1 Preparing the Data: Just like setting up our gear before an expedition, we'll clean and organize our data to ensure it's in top shape for analysis.

2 Seasonal Explorations: Imagine we're stargazers, observing the night sky throughout the year. We'll group sightings by season to see if there are any patterns or trends in when UFOs appear.

3 Astronomical Insights: Like astronomers tracking the movements of celestial bodies, we'll investigate if events like dusk, dawn, or twilight coincide with reported UFO sightings.

4 Visualizing the Journey: Using our artistic flair, we'll craft captivating visualizations that paint a vivid picture of UFO encounters across seasons and celestial events.

#### code

```{r,  fig.width=10,fig.height=6.5,fig.align='center'}

# Ufo sightings by part of the day (Naitik)

setDT(ufo_sightings)
df <- ufo_sightings[, .(sightings = .N), day_part]
View(df)

df <- na.omit(df)

df$day_part <- gsub("night","Night",df$day_part)
df$day_part <- gsub("nautical dusk","Nautical Dusk",df$day_part)
df$day_part <- gsub("afternoon","Afternoon",df$day_part)
df$day_part <- gsub("morning","Morning",df$day_part)
df$day_part <- gsub("astronomical dusk","Astronomical Dusk",df$day_part)
df$day_part <- gsub("civil dusk","Civil Dusk",df$day_part)
df$day_part <- gsub("civil dawn","Civil Dawn",df$day_part)
df$day_part <- gsub("nautical dawn","Nautical Dawn",df$day_part)
df$day_part <- gsub("astronomical dawn","Astronomical Dawn",df$day_part)


ggplot(df, aes(x=reorder(day_part, sightings), y=sightings, fill=day_part)) +
  geom_bar(stat="identity") +
  coord_flip() +
  labs(title="UFO Sightings by Part of the Day",
       x="Part of the Day",
       y="Number of Sightings") +
  theme_minimal() +
  theme(legend.position="none",
    panel.grid.major = element_blank(), 
    panel.grid.minor = element_blank(),
    )


```

#### Analysis:

1.  **Initiating Data Preparation:**

    -   To ensure our expedition yielded meaningful insights, we commenced by meticulously preparing the data, laying a solid foundation for our analysis.

    -   Through careful cleaning and organization, we readied the dataset for the adventure ahead, ensuring accuracy and reliability in our findings.

2.  **Unveiling Seasonal Insights:**

    -   Like seasoned investigators, we delved into the data to unravel the mysteries of seasonal patterns in UFO sightings.

    -   Our exploration led us to uncover fascinating correlations between the changing seasons and the frequency of reported encounters, shedding light on nature's influence on these phenomena.

3.  **Exploring Astronomical Associations:**

    -   With a keen eye on the celestial realm, we ventured into the realm of astronomical events to understand their potential impact on reported UFO sightings.

    -   Through rigorous analysis, we sought to discern whether phenomena such as dusk, dawn, or twilight played a role in shaping the occurrence of these mysterious encounters.

## Conclusion

-   The geographic distribution analysis reveals hotspots of UFO sightings, particularly in certain areas of the United States, suggesting a correlation between location and UFO activity.

-   Seasonal Analysis reveals potential patterns in UFO sightings, with variations across different times of the year, while examination of Astronomical events suggest a potential influence on reported sightings.
